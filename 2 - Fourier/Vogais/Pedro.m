%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 1 - Preparação do código%%%% Boas práticas: limpeza de variáveis; variáveis globais%% Constantes; carregar bibliotecas;...%%%%% Limpezaclc; % limpa visual da tela de comandosclose all; % limpa as figurasclear all; % limpa as variáveis%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%[gk,fs] = audioread ('a.wav');%% 44 min%%https://mauabr-my.sharepoint.com/personal/vparro_maua_br/_layouts/15/onedrive.aspx?originalPath=aHR0cHM6Ly9tYXVhYnItbXkuc2hhcmVwb2ludC5jb20vOmY6L2cvcGVyc29uYWwvdnBhcnJvX21hdWFfYnIvRWpLQ1hHbmZHV2hBalNlYVc2Y3hKTTBCMjN4NWY3OThnT1pKckQxN190dGlLdz9ydGltZT1GaVZzYmhULTJFZw&id=%2Fpersonal%2Fvparro%5Fmaua%5Fbr%2FDocuments%2FIMT%2F2%20%2D%20IMT%2F3%20%2D%20Ano%202021%2FECM%20307%2F2021%2D03%2D26%2007%2E43%2E32%20Sistemas%20e%20sinais%20%2D%20turma%20L2%2099339844071%2Fzoom%5F0%2Emp4&parent=%2Fpersonal%2Fvparro%5Fmaua%5Fbr%2FDocuments%2FIMT%2F2%20%2D%20IMT%2F3%20%2D%20Ano%202021%2FECM%20307%2F2021%2D03%2D26%2007%2E43%2E32%20Sistemas%20e%20sinais%20%2D%20turma%20L2%2099339844071if (length(gk)> 5000)gk = gk(1:5:end,:);endN = length(gk);Ts = 1/fs;ws = 2*pi*fs;duracao = N*Ts;tempo = linspace(0,N*Ts,N);fmax = fs/2;frequencia = linspace(-fs/2,fs/2,N);resolucao = fs/N;wn = exp(-1i*2*pi/N);J = wn*ones(N, N);ExpM = [0:1:N-1]'*[0:1:N-1];M = J.^ExpM;Xf = M*gk;figure(1)stem(frequencia,abs(Xf),'k-','linewidth',3) % configura plot(x,y, cor azul e linha cheia)xlabel('Frequência em Hz') % tempo em segundosylabel('Amplitude') % amplitude em voltstitle('Espectro de amplitude') % títulogridauxi1 = length(frequencia);%amplitudes = abs(Xf(auxi1:length(Xf)));[valor , indice] = sort(abs(Xf));valor2 = valor;valor = flip(valor);indice2 = indice;indice = flip(indice);Form = valor(1);Form(end+1) = indice(1);funcao = (abs(Xf));for i=indice2(1): auxi1if (funcao((i-1),1) <= 1 && funcao((i-2),1) >= 1)display("IF 1")auxi3 = 0 ;for a = i : auxi1auxi3 = auxi3-1 ;if (funcao((a-1),1) <= 1)display("IF 2")aauxi3funcao(a:(a-auxi3),1)[valor1 , indice1] = sort(funcao(a:(a-auxi3),1));valor1 = flip(valor1);indice1 = flip(indice1);valor1Form(end+1) = valor1(1);Form(end+1) = indice1(1);break;endifendendend%[valor1 , indice1] = sort (Form);%valor1 = flip(valor1);%indice1 = flip(indice1);%Form%valor1%366display("fundamentais :")display("--------------------")display("F0 :")Form(1)display("frequencia F0 :")Form(2)display("--------------------")display("F1 :")Form(3)display("frequencia F1 :")Form(4)display("--------------------")display("F2 :")Form(5)display("frequencia F2 :")Form(6)display("--------------------")